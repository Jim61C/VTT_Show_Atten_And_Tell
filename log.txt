I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcudnn.so.5 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:00:1d.0
Total memory: 11.17GiB
Free memory: 11.11GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:1d.0)
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1604 get requests, put_count=1588 evicted_count=1000 eviction_rate=0.629723 and unsatisfied allocation rate=0.695761
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 100 to 110
image_idxs <type 'numpy.ndarray'> (119794,) int32
file_names <type 'numpy.ndarray'> (6513,) <U19
word_to_idx <type 'dict'> 12185
features <type 'numpy.ndarray'> (6513, 1, 2048) float32
captions <type 'numpy.ndarray'> (119794, 17) int32
Elapse time: 0.05
image_idxs <type 'numpy.ndarray'> (9123,) int32
file_names <type 'numpy.ndarray'> (497,) <U19
features <type 'numpy.ndarray'> (497, 1, 2048) float32
captions <type 'numpy.ndarray'> (9123, 17) int32
Elapse time: 0.00
The number of epoch: 40
Data size: 119794
Batch size: 512
Iterations per epoch: 234
Start training with pretrained Model..

Train loss at epoch 1 & iteration 30 (mini-batch G): 21.14145 (D): 0.03371 (LSTM): 0.00000
Video sample:  dummy/video5410.mp4
Ground truth  1: <START> someone putting basil leaves into a blender containing other vegetables .
Ground truth  2: <START> a man is adding about a tablespoon of seasoning to a mixture in a blender .
Ground truth  3: <START> some food is sitting inside of a cup .
Ground truth  4: <START> a guy sprinkles dried herbs onto food in a glass bowl .
Ground truth  5: <START> person is presenting the ingredients in the kitchen .
Ground truth  6: <START> man puts about a tablespoon of basil leaves inside a blender .
Ground truth  7: <START> the person adds the spices to the blender .
Ground truth  8: <START> a man is mixing a ingredient in to the bowl .
Ground truth  9: <START> powder added into .
Ground truth  10: <START> cherry is putting on the glass and pepper added .
Ground truth  11: <START> a man in kitchen preparing a recipe .
Ground truth  12: <START> a person seen dropping some basil leaf powder into a mixer containing some other ingredients .
Ground truth  13: <START> a person adds a lot of basil to what appears to be a smoothie .
Ground truth  14: <START> a partial clip of a someone mixing a recipe with seasoning salt .
Ground truth  15: <START> knife on a cutting board and adding spices to a blender .
Ground truth  16: <START> the man adds a table spoon of basil leaves into a cup of fresh fruits .
Ground truth  17: <START> vegetables are cut very carefully and neatly and put in the .
Ground truth  18: <START> basil is added to a blender that is next to a cutting board .
Ground truth  19: <START> a gentleman is giving directions for a recipe for making a sauce in a blender .
Generated caption: a person is cooking in a kitchen .

I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 4010 get requests, put_count=4053 evicted_count=1000 eviction_rate=0.246731 and unsatisfied allocation rate=0.244389
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 256 to 281

Train loss at epoch 1 & iteration 60 (mini-batch G): 14.42030 (D): 0.01664 (LSTM): 0.00000
Video sample:  dummy/video6428.mp4
Ground truth  1: <START> a person is talking .
Ground truth  2: <START> a man and woman talking about food .
Ground truth  3: <START> a man dressed in drag is cooking in his kitchen .
Ground truth  4: <START> a man is holding two plates infront of him .
Ground truth  5: <START> the woman had a unibrow .
Ground truth  6: <START> a woman shows food she prepared and instructs how to make it .
Ground truth  7: <START> a duo acts out a food parody .
Ground truth  8: <START> a man is spreading nutella onto a sandwich .
Ground truth  9: <START> a person with a unibrow is yelling about how to make food .
Ground truth  10: <START> a girl is talking about food .
Ground truth  11: <START> a humorous skit involving a person in costume giving cooking advice .
Ground truth  12: <START> girl doing a funny cooking show .
Ground truth  13: <START> a man speaks to the camera in the kitchen .
Ground truth  14: <START> a guy is explaining about the food preparation with funny .
Ground truth  15: <START> a man dressed in drag is cooking in his kitchen .
Ground truth  16: <START> guys are talking about food .
Ground truth  17: <START> a person is in a kitchen demonstrating how to make a certain food .
Ground truth  18: <START> a man looks at food as though it is ugly .
Ground truth  19: <START> a person is preparing a meal .
Ground truth  20: <START> a guy in a wig talking about food and nutella .
Generated caption: a man is talking about food .


Train loss at epoch 1 & iteration 90 (mini-batch G): 13.58973 (D): 0.00724 (LSTM): 0.00000
Video sample:  dummy/video1906.mp4
Ground truth  1: <START> a woman mixes various ingredients in a red pan .
Ground truth  2: <START> ingredients are put in a pan with oil to boil it .
Ground truth  3: <START> a lady is cooking vegetables together in a red pan .
Ground truth  4: <START> in the vessel the chopped vegetables are big cooked by a woman .
Ground truth  5: <START> there is a woman is adding vegetable with spice .
Ground truth  6: <START> a woman adds spinach to dish cooking in a red pan on a stove .
Ground truth  7: <START> a woman is giving instructions on how to cook a vegetable mixture .
Ground truth  8: <START> a chef adds spinach to a pan of meat sauce she is preparing .
Ground truth  9: <START> there is a woman making a dish with spinach .
Ground truth  10: <START> there is a woman is making a dish with a pan .
Ground truth  11: <START> a lady is putting green food into a red pot with other food .
Ground truth  12: <START> a person cooking all vegetables in small pieces in a bowl .
Ground truth  13: <START> a person doing a cooking show and mixing the ingredients for the recipe .
Ground truth  14: <START> there is a woman is making a dish with spinach .
Generated caption: a woman is cooking a dish in a pan and stirring it .


Train loss at epoch 1 & iteration 120 (mini-batch G): 14.66707 (D): 0.00645 (LSTM): 0.00000
Video sample:  dummy/video2883.mp4
Ground truth  1: <START> ad for the voice kids by .
Ground truth  2: <START> a person just finished singing in a tv reality show the voice for kids .
Ground truth  3: <START> a video segment shows an animation .
Ground truth  4: <START> the voice of kids a hand with two fingers up and a microphone .
Ground truth  5: <START> the voice is a television show .
Ground truth  6: <START> the man for the show .
Ground truth  7: <START> title block of the voice .
Ground truth  8: <START> a the voice kids video game is released .
Ground truth  9: <START> the voice kids ending segment .
Ground truth  10: <START> advertisement to vote for some tv show participant .
Ground truth  11: <START> singing competition for kids .
Ground truth  12: <START> there is an advertisement for the voice kids .
Ground truth  13: <START> a the voice kids video game is released .
Ground truth  14: <START> a clip of the television show the voice this is the kids version .
Ground truth  15: <START> this is a video of the voice kids .
Ground truth  16: <START> there was a brief clip of a concert then a picture of the voice promotion .
Ground truth  17: <START> a man is on stage .
Ground truth  18: <START> an advertisement shows for the kids version of the voice .
Ground truth  19: <START> the voice kids is asking a trivia question .
Generated caption: a video showing a clip from a tv show .


Train loss at epoch 1 & iteration 150 (mini-batch G): 14.49599 (D): 0.00990 (LSTM): 0.00000
Video sample:  dummy/video4407.mp4
Ground truth  1: <START> a person is checking a instrument for lab purpose .
Ground truth  2: <START> a science teacher demonstrates an experiment to his students .
Ground truth  3: <START> a teacher showing some experiment to the students in the class room .
Ground truth  4: <START> a teacher performing an experiment in the class as student looks on .
Ground truth  5: <START> a teacher gives a demonstration to some students in a school .
Ground truth  6: <START> a man with a very full beard is lecturing a class of students .
Ground truth  7: <START> the man in white is taking class using microphones .
Ground truth  8: <START> a man in a lab coat speaking in front of students in a classroom .
Ground truth  9: <START> bearded science teacher explaining to his students in the classroom .
Ground truth  10: <START> a guy in white coat gives a presentation to a group .
Ground truth  11: <START> a lecturer speaking about the camera to students .
Ground truth  12: <START> a aman in white dress explaing the camera .
Ground truth  13: <START> bearded teacher showing his scientific knowledge to the class room .
Ground truth  14: <START> a professor is showing some experiment in the class .
Ground truth  15: <START> with white coat taking a class to the students .
Ground truth  16: <START> a man in a white coat is talking to some kids .
Ground truth  17: <START> one lecturer can explain something to students in class .
Ground truth  18: <START> a professor is a white coat on about the string in his hand .
Generated caption: a man in a blue shirt is doing a science experiment .


Train loss at epoch 1 & iteration 180 (mini-batch G): 13.81284 (D): 0.00803 (LSTM): 0.00000
Video sample:  dummy/video3145.mp4
Ground truth  1: <START> this is a video a guy putting a sugar cube in water .
Ground truth  2: <START> a person is drawing a number on a sugar cube .
Ground truth  3: <START> a person is drawing a number on a wooden cube .
Ground truth  4: <START> a person writes on a sugar cube then drops it in water .
Ground truth  5: <START> a person is giving a tutorial for a science project .
Ground truth  6: <START> a guy a sugar cube .
Ground truth  7: <START> a man makes an object .
Ground truth  8: <START> a video on a sugar cube in water .
Ground truth  9: <START> steps to a trick are shown .
Ground truth  10: <START> man drawing on a block an putting it in water .
Ground truth  11: <START> a man drops a sugar cube into a cup of water .
Ground truth  12: <START> a person telling about sick science .
Ground truth  13: <START> steps to a trick are shown .
Ground truth  14: <START> someone is showing instructions about using a sugar cube .
Ground truth  15: <START> a man writing a number on a sugar cube .
Ground truth  16: <START> a person is drawing a number on a wooden cube .
Ground truth  17: <START> a five is draw on a square .
Generated caption: a man is drawing a flower on a piece of paper .


Train loss at epoch 1 & iteration 210 (mini-batch G): 13.84479 (D): 0.01043 (LSTM): 0.00000
Video sample:  dummy/video317.mp4
Ground truth  1: <START> the person rides in the boat in the lake .
Ground truth  2: <START> people are in a boat cruising on a body of water .
Ground truth  3: <START> people are going in the boat and they are enjoying the boat ride .
Ground truth  4: <START> a group of people are riding on a boat under a blue sky .
Ground truth  5: <START> a motor boat cuts through the dirty water with trees growing nearby .
Ground truth  6: <START> someone is filming a group of people on a boat speeding through the water .
Ground truth  7: <START> a group of people are travelling in a very small boat .
Ground truth  8: <START> a large group of people are going up river on a large boat .
Ground truth  9: <START> a boat is floating around on the water .
Ground truth  10: <START> driving diesel boat through the stream and waves are making waves .
Ground truth  11: <START> people stand at a rusty rail on a passenger boat moving down a muddy river .
Ground truth  12: <START> tourists are taking a boat trip on top of a big yacht .
Ground truth  13: <START> some people are travelling in a boat in the river with scenic shores .
Ground truth  14: <START> red umbrellas are visible from the deck of a boat on some very brown water .
Ground truth  15: <START> some people on a boat are floating around out side .
Generated caption: a boat is going on the water and the boat is very fastly .


Previous epoch loss:  -1
Previous epoch generator loss:  -1
Previous epoch discriminator loss:  -1
Previous epoch LSTM loss:  -1

Current epoch loss:  3665.7281661
Current epoch generator loss:  3662.29736632
Current epoch discriminator loss:  3.43080410751
Current epoch LSTM loss:  0
Elapsed time:  269.681632996

n_iters_val =  1
Val video sample:  dummy/video6513.mp4
Val ground truth  1: <START> a woman is singing a song with others in the background .
Val ground truth  2: <START> a family is having coversation .
Val ground truth  3: <START> a girl sings i wish that i could be like the cool kids .
Val ground truth  4: <START> a music video about a social situation .
Val ground truth  5: <START> a music video featuring a girl and a sunset for the song cool kids .
Val ground truth  6: <START> a music video where a nerdy girl wishes she was like the cool kids .
Val ground truth  7: <START> a video song about cool kids .
Val ground truth  8: <START> a woman sings to the camera .
Val ground truth  9: <START> a woman is on the couch with her friends .
Val ground truth  10: <START> home made video of a popular song over .
Val ground truth  11: <START> a woman sings to the camera .
Val ground truth  12: <START> young people talking each other .
Val ground truth  13: <START> video of some girls singing by a beach .
Val ground truth  14: <START> two girls and a guy are talking on a couch while music is playing .
Val ground truth  15: <START> three people are sitting on a couch .
Val ground truth  16: <START> the girl sings on the couch .
Val ground truth  17: <START> people are sitting on a couch arguing while music plays .
Val generated caption: a woman is talking to a man in a room with a woman .

Saved ./data_MSRVTT/val/val.candidate.captions.pkl..
{'reflen': 5886, 'guess': [6239, 5742, 5245, 4748], 'testlen': 6239, 'correct': [4276, 2065, 946, 410]}
ratio: 1.05997281685
Bleu_1:	0.68536624459
Bleu_2:	0.496466317525
Bleu_3:	0.354248816122
Bleu_4:	0.248914153813
METEOR:	0.265395910666
ROUGE_L: 0.56264535236
CIDEr:	0.280644019161
Bleu_4+METEOR+CIDEr:	0.79495408364
model-1 saved.

Train loss at epoch 2 & iteration 30 (mini-batch G): 16.57559 (D): 0.00148 (LSTM): 0.00000
Video sample:  dummy/video4644.mp4
Ground truth  1: <START> a slideshow of tesla and his technology .
Ground truth  2: <START> an old picture with electricity or lightening bolts going through it .
Ground truth  3: <START> a man s photograph is shown with animated special effects mimicking electricity .
Ground truth  4: <START> picture of old guy .
Ground truth  5: <START> black and white picture with electricity going across them .
Ground truth  6: <START> a black and white series of photos depict tesla .
Ground truth  7: <START> black and white picture with electricity going across them .
Ground truth  8: <START> images of tesla are shown in a black and white video .
Ground truth  9: <START> a photo montage of tesla is shown in this video .
Ground truth  10: <START> a man is shown with electricity jumping about .
Ground truth  11: <START> electricity is in a warehouse .
Ground truth  12: <START> a man is having his picture taken .
Ground truth  13: <START> a silent video of black and white imagery .
Ground truth  14: <START> a picture of a man around electricity .
Ground truth  15: <START> a person is being shown .
Ground truth  16: <START> a man is sitting by a tesla .
Ground truth  17: <START> electricity is coming out of a man s face .
Ground truth  18: <START> an old black and white picture of a man .
Ground truth  19: <START> black and white picture with electricity going across them .
Ground truth  20: <START> a person is being shown .
Generated caption: a man is talking about a movie scene of a man and a woman talking to each


Train loss at epoch 2 & iteration 60 (mini-batch G): 14.61674 (D): 0.00072 (LSTM): 0.00000
Video sample:  dummy/video4921.mp4
Ground truth  1: <START> there is a taking place regarding differences on a money issue in england .
Ground truth  2: <START> two women and two men were talking about something in news show .
Ground truth  3: <START> girls and boy standing speaking arguing question audience watching sitting displaying on screen .
Ground truth  4: <START> there are some people standing and talking in the stage .
Ground truth  5: <START> four persons are discussing about a topic in a news channel .
Ground truth  6: <START> here is a talk show where different speakers are standing in front of a podium .
Ground truth  7: <START> four candidates in front of podiums are questioned during a debate .
Ground truth  8: <START> a group of four politicians debate some issues from behind podiums .
Ground truth  9: <START> the men and stand at a podium and talk to one another .
Ground truth  10: <START> a men and a women are participating in the tv show .
Ground truth  11: <START> a debate between four politicians consisting of two females and two males with a moderator .
Generated caption: a man and a woman are talking about something in a stage in front of a crowd


Train loss at epoch 2 & iteration 90 (mini-batch G): 16.61022 (D): 0.01190 (LSTM): 0.00000
Video sample:  dummy/video1868.mp4
Ground truth  1: <START> a guy is cutting a root in half then slicing the each half into pieces .
Ground truth  2: <START> a person is slicing cucumber on a table into pieces in a kitchen .
Ground truth  3: <START> in the kitchen there is a man slicing some vegetables .
Ground truth  4: <START> the chef chops the leeks lengthwise then into small slices .
Ground truth  5: <START> a man is chopping green onions into small pieces .
Ground truth  6: <START> a person doing a cooking show and showing the ingredients for the recipe .
Ground truth  7: <START> a man slices leaks lengthwise and then into small pieces .
Ground truth  8: <START> a man chops up leeks to make leek soup .
Ground truth  9: <START> man prepares leeks for cooking by cutting them in half lengthwise and then slicing them .
Ground truth  10: <START> a male chef demonstrates and describes cutting leaks into very small pieces .
Ground truth  11: <START> a chef prepares for a recipe by slicing some leaks .
Ground truth  12: <START> a man in a kitchen cutting leeks on a wood block .
Ground truth  13: <START> a man is cutting leaks in a kitchen while he narrates it .
Ground truth  14: <START> a cook a meal by cutting up some greens on the cutting board .
Ground truth  15: <START> a woman is preparing a food item .
Ground truth  16: <START> someone has cooked a delicious soup and served in white porcelain cup .
Ground truth  17: <START> a male prepares leeks by slicing them in half lengthwise and then dicing them .
Ground truth  18: <START> a person cuts the vegetables into fine pieces .
Generated caption: a man is cutting a potato salad with a knife on a cutting board .


Train loss at epoch 2 & iteration 120 (mini-batch G): 16.56903 (D): 0.00919 (LSTM): 0.00000
Video sample:  dummy/video6479.mp4
Ground truth  1: <START> the various rooms and features of a school are being presented .
Ground truth  2: <START> it is a high school building being viewed from the front .
Ground truth  3: <START> a building is being displayed .
Ground truth  4: <START> someone is filming a building .
Ground truth  5: <START> a video tour of a school s cafeteria .
Ground truth  6: <START> a building is being shown .
Ground truth  7: <START> views of a school building are shown .
Ground truth  8: <START> showing parts of a high school .
Ground truth  9: <START> it show the outside part of a building and an indoor region .
Ground truth  10: <START> someone showing some houses and .
Ground truth  11: <START> someone is filming a building .
Ground truth  12: <START> a camera pans around various locations around a high school campus .
Ground truth  13: <START> a camera is panning around a high school .
Ground truth  14: <START> a camera pans around a high school .
Ground truth  15: <START> a beautiful building on the screen .
Ground truth  16: <START> the exterior and interior of a building is being shown .
Ground truth  17: <START> a high school is shown .
Ground truth  18: <START> it is a video of a school building .
Ground truth  19: <START> a camera showing a high school building the video does not have audio .
Ground truth  20: <START> clip of school room .
Generated caption: a woman is walking through a building with a lot of trees and a building is shown


Train loss at epoch 2 & iteration 150 (mini-batch G): 17.11660 (D): 0.00067 (LSTM): 0.00000
Video sample:  dummy/video2113.mp4
Ground truth  1: <START> billboard for a cafe in .
Ground truth  2: <START> artwork for the rain forest cafe .
Ground truth  3: <START> a shot of the sign to the rainforest cafe .
Ground truth  4: <START> a cafe sign with animals .
Ground truth  5: <START> a sign is shown describing rainforest cafe a wild place to shop and eat .
Ground truth  6: <START> there is a sign for a rainforest cafe .
Ground truth  7: <START> artwork for the rain forest cafe .
Ground truth  8: <START> footage from a rainforest cafe is being shown .
Ground truth  9: <START> video showing the sign to a cafe .
Ground truth  10: <START> a person is taking a video of a logo for rainforest cafe .
Ground truth  11: <START> someone records a video of a rainforest cafe sign .
Ground truth  12: <START> the logo of a restuarant is shown .
Ground truth  13: <START> a restaurant sign is being shown .
Ground truth  14: <START> the sign to the rainforest cafe .
Ground truth  15: <START> ad for rainforest cafe a wild place to shop and eat .
Ground truth  16: <START> a logo is displayed .
Ground truth  17: <START> there is a logo of a cafe with background rainforest noises .
Ground truth  18: <START> animated game with animals in a rain forest .
Ground truth  19: <START> video of rainforest cafe sign .
Ground truth  20: <START> ad for rainforest cafe a wild place to shop and eat .
Generated caption: a man is talking about a video game character is shown in a video game .


Train loss at epoch 2 & iteration 180 (mini-batch G): 17.77257 (D): 0.00027 (LSTM): 0.00000
Video sample:  dummy/video4040.mp4
Ground truth  1: <START> women k pop group performing .
Ground truth  2: <START> a group of girls singing on a stage to an audience .
Ground truth  3: <START> the girl band sings on the stage .
Ground truth  4: <START> the girl band sings on the stage .
Ground truth  5: <START> some people are dancing and singing on stage .
Ground truth  6: <START> the group performed on stage .
Ground truth  7: <START> an asian girl group sings on stage .
Ground truth  8: <START> women are singing and dancing on stage .
Ground truth  9: <START> a girl band is singing on a stage .
Ground truth  10: <START> an all woman group singing and dancing on stage .
Ground truth  11: <START> a woman is singing .
Ground truth  12: <START> a group of people dance and sing on stage .
Ground truth  13: <START> bunch of pretty girls singing and dancing in tv show .
Ground truth  14: <START> seven girls singing and dancing on a stage .
Ground truth  15: <START> seven girls singing and dancing on a stage .
Ground truth  16: <START> a group of girls is giving a performance .
Ground truth  17: <START> all girls are singing in a stage show .
Ground truth  18: <START> a group of women sing and dance together on a brightly colored stage .
Ground truth  19: <START> a sings and wears a hat .
Ground truth  20: <START> a band of young woman performing in front of an audience .
Generated caption: a group of women are singing and dancing on stage with a band on stage .


Train loss at epoch 2 & iteration 210 (mini-batch G): 16.70789 (D): 0.00747 (LSTM): 0.00000
Video sample:  dummy/video5338.mp4
Ground truth  1: <START> a man in a plaid shirt showing different tools lying on a piece of wood .
Ground truth  2: <START> a man standing near a work area near a hammer and other tools .
Ground truth  3: <START> a man is standing in front of a metal wall talking about building something .
Ground truth  4: <START> there is a check shirt man is talking from a garage .
Ground truth  5: <START> a man in a plaid shirt is showing tools required to build something .
Ground truth  6: <START> a man is showing the tools of mechanic work .
Ground truth  7: <START> a man in plaid stands near a board with tools on it .
Ground truth  8: <START> a guy shows different tools in his work area .
Ground truth  9: <START> there is a check shirt man talking from a garage .
Ground truth  10: <START> a person shows the tools used in his workshop to repair something .
Ground truth  11: <START> tools are displayed while a man explains what they will be used for .
Ground truth  12: <START> a person showing different tools that will be used on building something .
Ground truth  13: <START> a man in a plaid shirt is describing tools you need for a job .
Ground truth  14: <START> there are some objects scattered on the ground .
Ground truth  15: <START> plaid shirt guy talks shows axe and raccoon .
Ground truth  16: <START> a man walks into a shop where there are many tools .
Generated caption: a man is talking about a machine that is working on a machine that is working on


Previous epoch loss:  3665.7281661
Previous epoch generator loss:  3662.29736632
Previous epoch discriminator loss:  3.43080410751
Previous epoch LSTM loss:  0

Current epoch loss:  3774.46518803
Current epoch generator loss:  3773.36922073
Current epoch discriminator loss:  1.09597162545
Current epoch LSTM loss:  0
Elapsed time:  549.10508585

n_iters_val =  1
Val video sample:  dummy/video6513.mp4
Val ground truth  1: <START> a woman is singing a song with others in the background .
Val ground truth  2: <START> a family is having coversation .
Val ground truth  3: <START> a girl sings i wish that i could be like the cool kids .
Val ground truth  4: <START> a music video about a social situation .
Val ground truth  5: <START> a music video featuring a girl and a sunset for the song cool kids .
Val ground truth  6: <START> a music video where a nerdy girl wishes she was like the cool kids .
Val ground truth  7: <START> a video song about cool kids .
Val ground truth  8: <START> a woman sings to the camera .
Val ground truth  9: <START> a woman is on the couch with her friends .
Val ground truth  10: <START> home made video of a popular song over .
Val ground truth  11: <START> a woman sings to the camera .
Val ground truth  12: <START> young people talking each other .
Val ground truth  13: <START> video of some girls singing by a beach .
Val ground truth  14: <START> two girls and a guy are talking on a couch while music is playing .
Val ground truth  15: <START> three people are sitting on a couch .
Val ground truth  16: <START> the girl sings on the couch .
Val ground truth  17: <START> people are sitting on a couch arguing while music plays .
Val generated caption: a girl is talking to a man and a woman is sitting on a couch .

Saved ./data_MSRVTT/val/val.candidate.captions.pkl..
{'reflen': 6804, 'guess': [7876, 7379, 6882, 6385], 'testlen': 7876, 'correct': [4668, 2214, 998, 410]}
ratio: 1.15755437978
Bleu_1:	0.592686642966
Bleu_2:	0.421699050399
Bleu_3:	0.295443001206
Bleu_4:	0.201725601244
METEOR:	0.249021784676
ROUGE_L: 0.471394910587
CIDEr:	0.179040821203
Bleu_4+METEOR+CIDEr:	0.629788207124
model-2 saved.

Train loss at epoch 3 & iteration 30 (mini-batch G): 17.02668 (D): 0.01037 (LSTM): 0.00000
Video sample:  dummy/video911.mp4
Ground truth  1: <START> a man speaks to a tv show host on stage .
Ground truth  2: <START> a talk show host is drinking a drink .
Ground truth  3: <START> a man jumps out of a cake on the david letterman show .
Ground truth  4: <START> a celebrity gets out of a cake and talks with a talk show host .
Ground truth  5: <START> a man speaks to a tv show host on stage .
Ground truth  6: <START> david letterman and bill murray are talking .
Ground truth  7: <START> a woman teases a late show episode .
Ground truth  8: <START> a man is drinking .
Ground truth  9: <START> bill murray and david letterman are doing silly things on the talk show .
Ground truth  10: <START> a man is covered in white stuff on a late night talk show .
Ground truth  11: <START> bill murray is popping out of a cake .
Ground truth  12: <START> on a television show an actor does humorous stunts .
Ground truth  13: <START> bill murray is being interviewed .
Ground truth  14: <START> bill murry on david letterman .
Ground truth  15: <START> one person is drinking milk .
Ground truth  16: <START> a woman talks about letterman s final episode of the late show .
Ground truth  17: <START> a comedian on the next to last david letterman show .
Ground truth  18: <START> bill murray jumps out of a cake on david letterman s last show .
Ground truth  19: <START> two men are doing funny incidents .
Ground truth  20: <START> a women is describing a video clip from the david letterman show .
Generated caption: a man is talking to a man in a suit and a woman talking to a man


Train loss at epoch 3 & iteration 60 (mini-batch G): 19.18545 (D): 0.00213 (LSTM): 0.00000
Video sample:  dummy/video5076.mp4
Ground truth  1: <START> a woman talking on talkshow .
Ground truth  2: <START> a man turns on a mixer .
Ground truth  3: <START> a person pours some food into a mixer .
Ground truth  4: <START> a man putting ingredients into a mixer then mixing them then putting more ingredients in .
Ground truth  5: <START> a demonstration of mixing ingredients .
Ground truth  6: <START> a group is fighting .
Ground truth  7: <START> someone is showing some food recipe .
Ground truth  8: <START> someone using a stand mixer and describing steps in a recipe .
Ground truth  9: <START> a man is pouring ingredients into a mixer .
Ground truth  10: <START> person using a mixer .
Ground truth  11: <START> man cooking and giving instructions .
Ground truth  12: <START> someone using a kitchen appliance .
Ground truth  13: <START> a person is mixing ingredients using a mixer .
Ground truth  14: <START> someone is making in the kitchen .
Ground truth  15: <START> a person is blending ingredients .
Ground truth  16: <START> a man mixes cooking ingredients together .
Ground truth  17: <START> a person is mixing ingredients for a cake .
Ground truth  18: <START> a man is pouring ingredients into a mixer bowl .
Ground truth  19: <START> someone is making in the kitchen .
Ground truth  20: <START> a person is making food .
Generated caption: a man is cooking food in a kitchen with a spoon of food .


Train loss at epoch 3 & iteration 90 (mini-batch G): 18.43921 (D): 0.00376 (LSTM): 0.00000
Video sample:  dummy/video3866.mp4
Ground truth  1: <START> a man talking about the features of a car .
Ground truth  2: <START> a car is driving over a speed bump .
Ground truth  3: <START> a car drives down the road .
Ground truth  4: <START> a man is driving a car .
Ground truth  5: <START> man explaining about a car s features .
Ground truth  6: <START> person talking about features of a car .
Ground truth  7: <START> guy riding a new car .
Ground truth  8: <START> a man is talking while in a car .
Ground truth  9: <START> a man describing the different aspects of an automobile .
Ground truth  10: <START> commercial for new car on tv .
Ground truth  11: <START> commercial for new car on tv .
Ground truth  12: <START> a man reviews a in spanish .
Ground truth  13: <START> a man is in a car .
Ground truth  14: <START> a foreign film a man shows us a new car and it s features .
Ground truth  15: <START> a man sits inside a car gesturing at different parts of it .
Ground truth  16: <START> a clip showcasing a silver modern car .
Ground truth  17: <START> a foreign man showing the inside view of a vehicle .
Ground truth  18: <START> the car was nice .
Ground truth  19: <START> person showing off their car .
Ground truth  20: <START> the car drives down the streets .
Generated caption: a man is driving a car and talking about it s features of a car .


Train loss at epoch 3 & iteration 120 (mini-batch G): 21.68125 (D): 0.01074 (LSTM): 0.00000
Video sample:  dummy/video149.mp4
Ground truth  1: <START> a clip from mad max .
Ground truth  2: <START> this is behind the scenes of the making of a movie .
Ground truth  3: <START> the car was used .
Ground truth  4: <START> various cars from mad max are shown .
Ground truth  5: <START> a man talks about mad car .
Ground truth  6: <START> cinema war sequence shooting .
Ground truth  7: <START> the actor appears from the .
Ground truth  8: <START> a person detailing a scene of movie .
Ground truth  9: <START> some behind the scenes talks about mad max go on .
Ground truth  10: <START> a man is driving a car .
Ground truth  11: <START> a man drive a car .
Ground truth  12: <START> a car is modified for a movie .
Ground truth  13: <START> someone talks about the vehicles that are featured in a movie .
Ground truth  14: <START> a man talking about the vehicles used on the mad max movie .
Ground truth  15: <START> scenes from a movie and acting is presented .
Ground truth  16: <START> a man is talking about clips of a movie .
Ground truth  17: <START> a man looking through binoculars .
Ground truth  18: <START> a desert action movie is presented .
Ground truth  19: <START> a man talks about the car for mad max .
Generated caption: a man is talking and a car is driving through the air and then a man is


Train loss at epoch 3 & iteration 150 (mini-batch G): 20.18351 (D): 0.01148 (LSTM): 0.00000
Video sample:  dummy/video4295.mp4
Ground truth  1: <START> woman with brown hair is talking about something in a kitchen .
Ground truth  2: <START> there is a lady is explaining some thing written on the screen .
Ground truth  3: <START> woman is talking about the videos on her channel .
Ground truth  4: <START> a lady is talking in left corner box .
Ground truth  5: <START> a woman advertising her youtube page she is instructing people to click the links below .
Ground truth  6: <START> a chef asking people to visit her youtube channel .
Ground truth  7: <START> a woman is advertising about recipe and subscribe to our social website .
Ground truth  8: <START> a lady is talking in the corner .
Ground truth  9: <START> the after page of a youtuber s video along with ads for additional videos .
Ground truth  10: <START> a woman explains about recipe and their facebook page .
Ground truth  11: <START> a woman in a checkered shirt is instructing viewers on how to subscribe .
Ground truth  12: <START> an animated woman with a spanish accent users to subscribe to her channel .
Ground truth  13: <START> online recipe program are to cooking and makes taste awareness .
Ground truth  14: <START> kitchen show host asks the viewers to subscribe to her content .
Ground truth  15: <START> black haired woman is presenting another recipe on her channel .
Generated caption: a woman is talking about a website with a picture of a man and a woman .


Train loss at epoch 3 & iteration 180 (mini-batch G): 20.71305 (D): 0.00648 (LSTM): 0.00000
Video sample:  dummy/video3062.mp4
Ground truth  1: <START> someone playing a video game .
Ground truth  2: <START> two characters in a video game about to do battle .
Ground truth  3: <START> a person is playing a fighting game .
Ground truth  4: <START> its a animated video .
Ground truth  5: <START> the character holds a sword .
Ground truth  6: <START> a clip from a fighting video game .
Ground truth  7: <START> a players introduces the red team .
Ground truth  8: <START> a video game woman has a sword .
Ground truth  9: <START> a digital movie with a spiked hair teen .
Ground truth  10: <START> a video game character speaks japanese while wielding its weapon .
Ground truth  11: <START> the anime characters are ready to fight .
Ground truth  12: <START> a person playing a video game and commentating .
Ground truth  13: <START> a video game woman has a sword .
Ground truth  14: <START> video game characters prepare to fight with swords .
Ground truth  15: <START> a person is playing a video game .
Ground truth  16: <START> a woman is holding a sword in a video game .
Ground truth  17: <START> two video game characters prepare to fight .
Generated caption: a man is fighting a sword from a man in a video game .


Train loss at epoch 3 & iteration 210 (mini-batch G): 20.00294 (D): 0.00924 (LSTM): 0.00000
Video sample:  dummy/video4566.mp4
Ground truth  1: <START> a guard uses a combo fake on his way to the basket .
Ground truth  2: <START> the basketball players set plays to drive the ball to the basket .
Ground truth  3: <START> team playing basketball a man is scoring goal .
Ground truth  4: <START> an nba player does a cross over and scores a basket .
Ground truth  5: <START> all persons are playing basketball each other .
Ground truth  6: <START> some basketball players are being filmed on a court .
Ground truth  7: <START> all people are playing basket ball in a stadium .
Ground truth  8: <START> two teams are involved in a basketball match and crowd is watching it .
Ground truth  9: <START> players are playing basketball and one had put a ball in basket .
Ground truth  10: <START> an nba player another player and makes the basket .
Ground truth  11: <START> a basketball game with a guy talking about .
Ground truth  12: <START> some people are on a basket ball court playing the game .
Ground truth  13: <START> basket ball team technique from ultimate players .
Ground truth  14: <START> players with white dress are tackling with opponents in red dress in a basketball match .
Ground truth  15: <START> more players are playing basket ball in the ground .
Ground truth  16: <START> a basketball coach describes plays that can be used in games .
Ground truth  17: <START> white and red dress playing basket ball jumping .
Ground truth  18: <START> men in blue is playing basketball with men in white .
Ground truth  19: <START> a group of players are playing volleyball in the stadium .
Ground truth  20: <START> a team in white t shirt playing basketball vs team with blue t shirt .
Generated caption: a basketball player dunks the ball and then a basketball player is dunking .


Previous epoch loss:  3774.46518803
Previous epoch generator loss:  3773.36922073
Previous epoch discriminator loss:  1.09597162545
Previous epoch LSTM loss:  0

Current epoch loss:  4609.03325939
Current epoch generator loss:  4607.19510269
Current epoch discriminator loss:  1.8381599971
Current epoch LSTM loss:  0
Elapsed time:  828.814762831

n_iters_val =  1
Val video sample:  dummy/video6513.mp4
Val ground truth  1: <START> a woman is singing a song with others in the background .
Val ground truth  2: <START> a family is having coversation .
Val ground truth  3: <START> a girl sings i wish that i could be like the cool kids .
Val ground truth  4: <START> a music video about a social situation .
Val ground truth  5: <START> a music video featuring a girl and a sunset for the song cool kids .
Val ground truth  6: <START> a music video where a nerdy girl wishes she was like the cool kids .
Val ground truth  7: <START> a video song about cool kids .
Val ground truth  8: <START> a woman sings to the camera .
Val ground truth  9: <START> a woman is on the couch with her friends .
Val ground truth  10: <START> home made video of a popular song over .
Val ground truth  11: <START> a woman sings to the camera .
Val ground truth  12: <START> young people talking each other .
Val ground truth  13: <START> video of some girls singing by a beach .
Val ground truth  14: <START> two girls and a guy are talking on a couch while music is playing .
Val ground truth  15: <START> three people are sitting on a couch .
Val ground truth  16: <START> the girl sings on the couch .
Val ground truth  17: <START> people are sitting on a couch arguing while music plays .
Val generated caption: a woman is interviewing a man and a woman who is a drink .

Saved ./data_MSRVTT/val/val.candidate.captions.pkl..
{'reflen': 6656, 'guess': [7389, 6892, 6395, 5898], 'testlen': 7389, 'correct': [4400, 1827, 746, 249]}
ratio: 1.11012620192
Bleu_1:	0.595479767221
Bleu_2:	0.397310592988
Bleu_3:	0.26407027784
Bleu_4:	0.166979550073
METEOR:	0.238527176337
ROUGE_L: 0.491274320623
CIDEr:	0.157655243876
Bleu_4+METEOR+CIDEr:	0.563161970285
model-3 saved.

Train loss at epoch 4 & iteration 30 (mini-batch G): 18.47309 (D): 0.01306 (LSTM): 0.00000
Video sample:  dummy/video5654.mp4
Ground truth  1: <START> cartoon characters are having dinner .
Ground truth  2: <START> a creature is telling a man how to talk .
Ground truth  3: <START> cartoon characters talking and interacting .
Ground truth  4: <START> cartoon characters talking and interacting .
Ground truth  5: <START> cartoon characters are having dinner .
Ground truth  6: <START> a cartoon with glasses .
Ground truth  7: <START> a game is being played .
Ground truth  8: <START> a panel of emotions as a father fails to read their messages .
Ground truth  9: <START> some cartoon characters are eating at a table .
Ground truth  10: <START> cartoon characters are having dinner .
Ground truth  11: <START> a family sitting down for dinner talks about their day .
Ground truth  12: <START> a cartoon with glasses .
Ground truth  13: <START> a family in an animated movie talk during dinner .
Ground truth  14: <START> a teacher talking to his students in a cartoon clip .
Ground truth  15: <START> animated charcter are disappointed about the actor they choose .
Ground truth  16: <START> a clip of a cartoon movie .
Ground truth  17: <START> a teacher talking to his students in a cartoon clip .
Ground truth  18: <START> a creature is telling a man how to talk .
Generated caption: a cartoon of a man and a woman talking to each other in a room .

